(function(b){function h(a){(a||b(".document-gallery[data-icon-width]")).each(function(){var a=b(this).data("icon-width");"undefined"!==typeof a&&b(this).find(".document-icon").width(a+"%")})}function p(){g&&tinymce.PluginManager.add("dg",function(a,d){a.on("LoadContent update.dg undo",function(a){b(a.target.contentDocument).find('[data-wpview-type="dg"] [data-shortcode]').each(function(){k(b.parseJSON(decodeURIComponent(b(this).data("shortcode"))),b(this))})})})}function q(){b("body").delegate(".dg-paginate-wrapper .paginate a",
"click",function(a){var d=b(this).closest(".dg-paginate-wrapper"),e=d.data("shortcode");e.skip=0;var c=b(this).attr("href").split("#")[1].split("=");2<=c.length&&(e.skip=e.limit*(c.pop()-1));k(e,d);a.preventDefault()})}function l(){c=[];f=0;b(".document-gallery img[data-id]").each(function(){var a=b(this).data("id");-1===b.inArray(a,c)&&c.push(a)});m()}function k(a,d){"undefined"===typeof a.id&&(a.id=wp.media.dgDefaults.id);b.post(ajaxurl,{action:"dg_generate_gallery",atts:a},function(a){a=b(b.parseHTML(a));
g&&!n&&a.find(r).length&&(n=!0,b("#insert-media-button").trigger("ready.dg"));d.replaceWith(a);h(a);l()})}function m(){for(var a=[];f<c.length&&4!==a.length;f++)a.push(c[f]);0!=a.length&&b.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"dg_generate_icons",ids:a},success:t,error:function(a){console.error(a.responseText)}})}function t(a){for(var d in a)if(a.hasOwnProperty(d)){var c=b('.document-gallery img[data-id="'+d+'"]');c.removeAttr("data-id");(function(c,d){d.fadeOut("fast",function(){b(this).attr("src",
a[c]);b(this).fadeIn("fast")})})(d,c)}m()}var c,f,g,r='.document-gallery [data-ext="'+"doc docx ppt pptx xls xlsx pub vsd vsdx".split(" ").join('"],[data-ext="')+'"]',n=!1;b(document).ready(function(){g="undefined"!==typeof tinymce;h();l();p();q()})})(jQuery);
